<!DOCTYPE html>
<html lang="pt-BR">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Simulado de Direito Tributário</title>
  <script src="https://cdn.tailwindcss.com"></script>
  <link rel="preconnect" href="https://fonts.googleapis.com">
  <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
  <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600;700&display=swap" rel="stylesheet">
  <style>
    body {
      font-family: 'Inter', sans-serif;
      background-color: #f3f4f6;
      display: flex;
      justify-content: center;
      align-items: center;
      min-height: 100vh;
      padding: 1rem;
    }
    .simulado-container {
      background-color: #ffffff;
      padding: 2rem;
      border-radius: 1rem;
      box-shadow: 0 4px 12px rgba(0, 0, 0, 0.1);
      max-width: 800px;
      width: 100%;
    }
    .header-info {
      display: flex;
      justify-content: space-between;
      align-items: center;
      margin-bottom: 1.5rem;
    }
    .question-box {
      background-color: #f9fafb;
      padding: 1.5rem;
      border-radius: 0.75rem;
      margin-bottom: 1.5rem;
      border: 1px solid #e5e7eb;
    }
    .question-text {
      font-size: 1.15rem;
      font-weight: 600;
      color: #1f2937;
      margin-bottom: 1.5rem;
      line-height: 1.6;
    }
    .options-container button {
      display: block;
      width: 100%;
      text-align: left;
      padding: 0.75rem 1rem;
      border-radius: 0.5rem;
      background-color: #ffffff;
      color: #374151;
      font-weight: 500;
      transition: all 0.2s ease;
      margin-bottom: 0.5rem;
      border: 1px solid #d1d5db;
      cursor: pointer;
    }
    .options-container button:hover:not(:disabled) {
      background-color: #f3f4f6;
      border-color: #6366f1;
    }
    .options-container button:disabled {
        cursor: not-allowed;
    }
    .options-container button.correct {
      background-color: #dcfce7;
      color: #166534;
      border-color: #4ade80;
      font-weight: 700;
    }
    .options-container button.incorrect {
      background-color: #fee2e2;
      color: #991b1b;
      border-color: #f87171;
      font-weight: 700;
    }
    .feedback-box {
      margin-top: 1.5rem;
      padding: 1rem;
      border-radius: 0.75rem;
      background-color: #f0fdf4;
      border: 1px solid #d1fae5;
      color: #065f46;
      display: none; /* Hidden by default */
    }
    .feedback-box.incorrect-feedback {
      background-color: #fef2f2;
      border-color: #fee2e2;
      color: #b91c1c;
    }
    .navigation-buttons {
      display: flex;
      justify-content: space-between;
      margin-top: 2rem;
    }
    .navigation-buttons button {
      padding: 0.75rem 1.5rem;
      font-size: 1rem;
      font-weight: 600;
      border-radius: 0.5rem;
      background-color: #4f46e5;
      color: white;
      transition: background-color 0.2s ease;
      border: none;
      cursor: pointer;
    }
    .navigation-buttons button:hover:not(:disabled) {
      background-color: #4338ca;
    }
    .navigation-buttons button:disabled {
      background-color: #a5b4fc;
      cursor: not-allowed;
    }
    .final-result {
      text-align: center;
      padding: 2rem 0;
    }
    .final-result-text {
      font-size: 1.75rem;
      font-weight: 700;
      color: #1f2937;
      margin-bottom: 1.5rem;
    }
    #restart-button {
      background-color: #10b981;
      color: white;
    }
    #restart-button:hover {
      background-color: #059669;
    }
  </style>
</head>
<body>

<div class="simulado-container">
  <h1 class="text-2xl font-bold text-center text-gray-800 mb-6">Simulado de Direito Tributário</h1>
  <!-- Progress Bar -->
  <div id="progress-bar-container" class="w-full bg-gray-200 rounded-full h-2.5 mb-4">
      <div id="progress-bar" class="bg-indigo-600 h-2.5 rounded-full transition-all duration-300" style="width: 0%"></div>
  </div>

  <div class="header-info">
    <span id="progress-text" class="text-sm font-medium text-gray-600">Questão 1 de 80</span>
    <span id="status-text" class="text-sm font-medium text-gray-600"></span>
  </div>

  <div id="quiz-content">
    <div class="question-box">
      <div id="question-text" class="question-text"></div>
      <div id="options-container" class="options-container"></div>
    </div>
    <div id="feedback-box" class="feedback-box">
      <div id="feedback-text"></div>
    </div>
  </div>

  <div id="final-result" class="final-result hidden">
    <div id="final-result-text" class="final-result-text"></div>
    <button id="restart-button" class="navigation-buttons button px-6 py-3 rounded-lg shadow-md transition-all">Reiniciar Simulado</button>
  </div>

  <div class="navigation-buttons">
    <button id="prev-button" disabled>Voltar</button>
    <button id="next-button">Avançar</button>
  </div>

  <div class="text-center mt-6">
      <p class="text-xs text-gray-400">© 2025 Todos os direitos reservados a Gabriel Angelino.</p>
      <p class="text-xs text-gray-400 mt-1">Criado com base no resumo de Adriana Azevedo.</p>
  </div>
</div>

<script>
  const questions = [
    { question: "De acordo com o Art. 3º do CTN, o que caracteriza um tributo?", options: ["Ser uma prestação voluntária.", "Ser uma sanção por ato ilícito.", "Ser uma prestação pecuniária compulsória que não constitua sanção por ato ilícito.", "Ser cobrado apenas pela União."], answer: "Ser uma prestação pecuniária compulsória que não constitua sanção por ato ilícito.", feedback: "O Art. 3º do CTN define tributo como toda prestação pecuniária compulsória, em moeda ou cujo valor nela se possa exprimir, que não constitua sanção de ato ilícito, instituída em lei e cobrada mediante atividade administrativa plenamente vinculada." },
    { question: "O que o princípio da Anterioridade, previsto no Art. 150, III, 'b' da CF/88, estabelece?", options: ["Proíbe a cobrança de tributos sobre fatos ocorridos antes da lei.", "Exige um prazo de 90 dias para a cobrança do tributo.", "Impede a cobrança de tributos no mesmo exercício financeiro em que a lei foi publicada.", "Permite que decretos aumentem tributos."], answer: "Impede a cobrança de tributos no mesmo exercício financeiro em que a lei foi publicada.", feedback: "O princípio da Anterioridade, também chamado de 'regra do exercício', veda a cobrança de tributos no mesmo ano em que foi publicada a lei que os instituiu ou aumentou, garantindo a previsibilidade para o contribuinte." },
    { question: "Impostos como IPTU e IPVA são classificados como tributos não vinculados. O que isso significa?", options: ["Sua arrecadação é vinculada a uma obra específica.", "O fato gerador depende de uma contraprestação do Estado.", "Sua cobrança não está atrelada a uma atividade estatal específica relativa ao contribuinte.", "São de competência exclusiva da União."], answer: "Sua cobrança não está atrelada a uma atividade estatal específica relativa ao contribuinte.", feedback: "Tributos não vinculados, como os impostos, têm como fato gerador uma manifestação de riqueza do contribuinte (ex: ser proprietário de imóvel), e sua receita destina-se ao custeio geral do Estado, não a uma atividade específica." },
    { question: "O princípio da Irretroatividade (Art. 150, III, 'a' da CF/88) protege o contribuinte ao proibir:", options: ["A cobrança de tributos no mesmo ano da publicação da lei.", "O confisco de bens por meio de tributos.", "A cobrança de tributos sobre fatos geradores ocorridos antes da vigência da lei.", "A criação de taxa para serviços essenciais."], answer: "A cobrança de tributos sobre fatos geradores ocorridos antes da vigência da lei.", feedback: "A Irretroatividade é a garantia de que a lei tributária não pode retroagir para atingir eventos que já aconteceram, preservando o direito adquirido e a segurança jurídica." },
    { question: "Qual é a principal diferença entre Imposto e Taxa?", options: ["O imposto é federal e a taxa é municipal.", "A taxa financia serviços universais e o imposto, serviços específicos.", "O imposto não é vinculado a uma atividade estatal, enquanto a taxa é vinculada.", "O imposto exige lei complementar e a taxa, lei ordinária."], answer: "O imposto não é vinculado a uma atividade estatal, enquanto a taxa é vinculada.", feedback: "A distinção fundamental está no fato gerador. O imposto incide sobre manifestações de riqueza do contribuinte. A taxa, por sua vez, decorre de uma atividade estatal específica: o exercício do poder de polícia ou a prestação de um serviço público específico e divisível." },
    { question: "O Imposto de Renda é considerado um imposto com caráter pessoal porque:", options: ["É pago por todas as pessoas do país.", "Sempre que possível, é graduado segundo a capacidade econômica do contribuinte.", "Incide apenas sobre o patrimônio pessoal.", "É de competência exclusiva da pessoa jurídica da União."], answer: "Sempre que possível, é graduado segundo a capacidade econômica do contribuinte.", feedback: "O caráter pessoal (Art. 145, §1º, CF/88) significa que o imposto deve levar em conta as características econômicas do contribuinte, o que se manifesta por meio da progressividade das alíquotas, em respeito à capacidade contributiva." },
    { question: "A imunidade tributária é uma limitação ao poder de tributar que tem origem:", options: ["Na lei ordinária.", "Na Constituição Federal.", "Em decretos do Poder Executivo.", "Na jurisprudência dos tribunais."], answer: "Na Constituição Federal.", feedback: "A imunidade é uma vedação constitucional ao poder de tributar. São hipóteses em que a própria Constituição impede que os entes federativos instituam tributos sobre determinadas pessoas, bens ou situações." },
    { question: "Para custear despesas extraordinárias decorrentes de calamidade pública, a União pode instituir qual tributo especial?", options: ["Imposto Extraordinário de Guerra.", "Empréstimo Compulsório.", "Contribuição de Melhoria.", "Taxa de Calamidade."], answer: "Empréstimo Compulsório.", feedback: "O Empréstimo Compulsório (Art. 148, I, da CF/88) pode ser instituído pela União, mediante lei complementar, para atender a despesas extraordinárias de calamidade pública ou guerra externa." },
    { question: "A regra da Noventena (Art. 150, III, 'c', CF/88) estabelece um prazo de:", options: ["30 dias.", "60 dias.", "90 dias.", "180 dias."], answer: "90 dias.", feedback: "A Noventena, ou anterioridade nonagesimal, exige um intervalo mínimo de 90 dias entre a publicação da lei que institui ou aumenta um tributo e o início de sua cobrança." },
    { question: "A capacidade para criar, aumentar ou extinguir tributos é chamada de:", options: ["Capacidade contributiva.", "Competência tributária.", "Obrigação tributária.", "Sujeição passiva."], answer: "Competência tributária.", feedback: "Competência tributária é o poder, atribuído pela Constituição aos entes federativos, para instituir tributos. É uma competência indelegável." },
    { question: "Os tributos e multas são classificados como qual tipo de receita para o Estado?", options: ["Receita originária.", "Receita derivada.", "Receita contratual.", "Receita patrimonial."], answer: "Receita derivada.", feedback: "A receita derivada é aquela que o Estado obtém por meio de seu poder de império (coerção), como a cobrança de tributos e multas, diferentemente da receita originária, que vem da exploração de seu próprio patrimônio." },
    { question: "Um município que cria uma 'taxa de saúde' para custear o atendimento odontológico da população de baixa renda comete qual inconstitucionalidade?", options: ["Nenhuma, pois o município tem competência para criar taxas.", "A saúde não pode ser financiada por tributos.", "Violação do princípio da legalidade.", "Instituição de taxa para custear serviço público universal (uti universi)."], answer: "Instituição de taxa para custear serviço público universal (uti universi).", feedback: "Serviços públicos universais, como saúde e segurança, que beneficiam toda a coletividade, devem ser custeados por impostos (tributos não vinculados). As taxas só podem remunerar serviços específicos e divisíveis (uti singuli)." },
    { question: "O princípio da Legalidade Estrita em matéria tributária significa que um tributo só pode ser criado ou aumentado por:", options: ["Medida Provisória.", "Decreto.", "Portaria.", "Lei em sentido formal."], answer: "Lei em sentido formal.", feedback: "O princípio da legalidade (Art. 150, I, CF/88) exige lei ordinária ou complementar para a instituição ou majoração de tributos, como garantia do cidadão contra o arbítrio do Fisco." },
    { question: "A competência da União para criar impostos não previstos na Constituição é chamada de:", options: ["Competência privativa.", "Competência extraordinária.", "Competência comum.", "Competência residual."], answer: "Competência residual.", feedback: "A competência residual (Art. 154, I, CF/88) permite à União criar novos impostos, desde que por meio de lei complementar e que não tenham fato gerador ou base de cálculo próprios dos impostos já existentes." },
    { question: "A principal característica das Contribuições Especiais (ex: CIDE, PIS/COFINS) é:", options: ["Serem de competência estadual.", "Não precisarem de lei para sua criação.", "A destinação específica de sua arrecadação.", "Serem sempre não cumulativas."], answer: "A destinação específica de sua arrecadação.", feedback: "Diferentemente dos impostos, cuja receita vai para o 'caixa geral', as contribuições especiais têm sua arrecadação vinculada a uma finalidade específica, como financiar a seguridade social ou a intervenção no domínio econômico." },
    { question: "O princípio da seletividade, aplicável ao IPI e ICMS, determina que as alíquotas devem variar em função da:", options: ["Capacidade contributiva do sujeito passivo.", "Região onde o produto é consumido.", "Essencialidade do produto ou serviço.", "Receita bruta da empresa."], answer: "Essencialidade do produto ou serviço.", feedback: "Pela seletividade, produtos e serviços considerados mais essenciais (ex: alimentos) devem ter alíquotas menores, enquanto os supérfluos (ex: cigarros, bebidas alcoólicas) devem ter alíquotas maiores." },
    { question: "O princípio que proíbe a União de instituir tributos que não sejam uniformes em todo o território nacional é o da:", options: ["Isonomia.", "Uniformidade Geográfica.", "Capacidade Contributiva.", "Não-discriminação."], answer: "Uniformidade Geográfica.", feedback: "Este princípio (Art. 151, I, da CF/88) veda à União conceder tratamentos tributários distintos para Estados, DF ou Municípios, garantindo o equilíbrio e a coesão da federação." },
    { question: "A imunidade que impede a União, os Estados e os Municípios de cobrarem impostos uns dos outros sobre patrimônio, renda e serviços é chamada de:", options: ["Imunidade religiosa.", "Imunidade sindical.", "Imunidade recíproca.", "Imunidade de imprensa."], answer: "Imunidade recíproca.", feedback: "A imunidade recíproca (Art. 150, VI, 'a', da CF/88) é uma cláusula pétrea que visa preservar o pacto federativo, impedindo que um ente político tribute o outro." },
    { question: "O fato de o ICMS ser de competência estadual e o IPI ser de competência federal, ambos incidindo sobre produtos industrializados, evita a ocorrência de:", options: ["Guerra fiscal.", "Bitributação.", "Tributação em cascata.", "Evasão fiscal."], answer: "Bitributação.", feedback: "A Constituição distribui as competências de forma a evitar a bitributação, que ocorre quando dois entes políticos distintos cobram tributos sobre o mesmo fato gerador. No caso, os fatos geradores do IPI e do ICMS são distintos." },
    { question: "Qual dos seguintes impostos, por seu caráter extrafiscal, pode ter suas alíquotas alteradas por ato do Poder Executivo (decreto), como exceção ao princípio da legalidade?", options: ["IPTU.", "ITCMD.", "Imposto de Importação (II).", "IPVA."], answer: "Imposto de Importação (II).", feedback: "Os impostos com função predominantemente regulatória (extrafiscal), como o II, IE, IPI e IOF, podem ter suas alíquotas alteradas por decreto para dar mais agilidade à política econômica, mitigando a legalidade estrita." },
    { question: "Em caso de guerra externa iminente ou declarada, a União pode instituir, de forma imediata, o:", options: ["Empréstimo compulsório de guerra.", "Imposto Extraordinário de Guerra (IEG).", "Ambos podem ser instituídos.", "Apenas a CIDE-Guerra."], answer: "Ambos podem ser instituídos.", feedback: "A Constituição autoriza a União a instituir, em caso de guerra, tanto o Empréstimo Compulsório (Art. 148) quanto o Imposto Extraordinário de Guerra (Art. 154, II), ambos dispensados dos princípios da anterioridade." },
    { question: "A imunidade de impostos sobre livros, jornais, periódicos e o papel destinado à sua impressão visa proteger qual direito fundamental?", options: ["Direito de propriedade.", "Liberdade de expressão e de informação.", "Direito à educação.", "Livre iniciativa."], answer: "Liberdade de expressão e de informação.", feedback: "Essa imunidade (Art. 150, VI, 'd', CF/88) tem o objetivo de baratear o custo de veículos de informação e cultura, promovendo a liberdade de expressão, o debate de ideias e o acesso à educação." },
    { question: "Qual dos seguintes tributos NÃO precisa obedecer ao princípio da noventena?", options: ["Imposto de Renda (IR).", "Imposto sobre Produtos Industrializados (IPI).", "Imposto de Exportação (IE).", "Contribuições Sociais."], answer: "Imposto de Exportação (IE).", feedback: "O Imposto de Exportação (IE), juntamente com o II, IOF e o Imposto Extraordinário de Guerra, são exceções à noventena por seu caráter regulatório e urgente." },
    { question: "O fato gerador da Contribuição de Melhoria é:", options: ["A prestação de um serviço público.", "O exercício do poder de polícia.", "A valorização de imóvel decorrente de obra pública.", "A obtenção de renda pelo contribuinte."], answer: "A valorização de imóvel decorrente de obra pública.", feedback: "A Contribuição de Melhoria (Art. 81 do CTN) é um tributo vinculado a uma atuação estatal que gera um benefício direto ao contribuinte, especificamente a valorização do seu imóvel em decorrência de uma obra pública." },
    { question: "O princípio que proíbe a utilização de tributo com efeito de confisco está previsto no Art. 150, IV, da CF/88. O que ele veda?", options: ["A cobrança de multas junto com o tributo.", "Que a carga tributária seja tão excessiva a ponto de aniquilar a propriedade ou a renda.", "A progressividade de alíquotas.", "A cobrança de tributos sobre o mínimo existencial."], answer: "Que a carga tributária seja tão excessiva a ponto de aniquilar a propriedade ou a renda.", feedback: "A vedação ao confisco protege o direito de propriedade, impedindo que o Estado, por meio de tributos, se aproprie de parcela substancial do patrimônio ou da renda do contribuinte." },
    { question: "O que significa dizer que o Imposto de Renda (IR) se submete à 'anterioridade mitigada'?", options: ["Ele só obedece à noventena.", "Ele só obedece à anterioridade de exercício.", "Ele obedece a ambas as anterioridades (anual e nonagesimal).", "Ele não obedece a nenhuma anterioridade."], answer: "Ele obedece a ambas as anterioridades (anual e nonagesimal).", feedback: "O IR deve respeitar tanto a anterioridade anual (só pode ser cobrado no ano seguinte) quanto a noventena (mínimo de 90 dias da publicação da lei), por isso sua cobrança é, na prática, a partir de 1º de janeiro do ano seguinte, desde que a lei seja publicada até o fim de setembro." },
    { question: "O princípio da Capacidade Contributiva determina que, sempre que possível, os impostos devem:", options: ["Ser fixos para todos.", "Ser cobrados apenas de pessoas jurídicas.", "Ser graduados conforme a riqueza do contribuinte.", "Ser vinculados a um serviço estatal."], answer: "Ser graduados conforme a riqueza do contribuinte.", feedback: "Este princípio (Art. 145, § 1º, da CF/88) é a base da justiça fiscal, buscando onerar mais quem tem maior capacidade econômica e desonerar quem tem menos." },
    { question: "A CIDE-Combustíveis é um exemplo de qual espécie tributária?", options: ["Imposto.", "Taxa.", "Contribuição de Intervenção no Domínio Econômico.", "Empréstimo Compulsório."], answer: "Contribuição de Intervenção no Domínio Econômico.", feedback: "A CIDE é uma Contribuição Especial (subespécie Intervenção no Domínio Econômico) cuja finalidade é regular o setor de combustíveis e financiar projetos ambientais e de infraestrutura de transporte." },
    { question: "A principal função do Código Tributário Nacional (CTN), que tem status de Lei Complementar, é:", options: ["Criar todos os impostos federais.", "Definir as competências de cada ente federativo.", "Estabelecer as normas gerais de Direito Tributário válidas para toda a federação.", "Regular o processo judicial tributário."], answer: "Estabelecer as normas gerais de Direito Tributário válidas para toda a federação.", feedback: "O CTN (Lei 5.172/66) veicula as normas gerais sobre obrigação, crédito, lançamento, prescrição, decadência, etc., que devem ser observadas pela União, Estados, DF e Municípios ao legislarem sobre seus tributos." },
    { question: "Qual a diferença fundamental entre Anistia e Remissão?", options: ["Anistia perdoa o tributo e a remissão perdoa a multa.", "Anistia é concedida pela União e remissão pelos Estados.", "Anistia perdoa a multa por infração, enquanto a remissão perdoa a dívida do tributo (o principal).", "Anistia suspende a cobrança e a remissão extingue."], answer: "Anistia perdoa a multa por infração, enquanto a remissão perdoa a dívida do tributo (o principal).", feedback: "Ambas são causas de exclusão e extinção do crédito, respectivamente. A anistia (Art. 180 CTN) foca nas penalidades (multas). A remissão (Art. 172 CTN) é o perdão da dívida principal." },
    { question: "A combinação dos princípios da Anterioridade Anual e da Noventena resulta em que regra prática?", options: ["O tributo só pode ser cobrado 90 dias após o início do ano seguinte.", "A lei que majora o tributo deve ser publicada até 30 de setembro para valer no ano seguinte.", "A cobrança só pode ocorrer no ano seguinte e, no mínimo, 90 dias após a publicação da lei.", "Apenas impostos federais se submetem a essa regra dupla."], answer: "A cobrança só pode ocorrer no ano seguinte e, no mínimo, 90 dias após a publicação da lei.", feedback: "As duas regras são cumulativas. O tributo só pode ser cobrado após o dia 1º de janeiro do ano seguinte E após decorridos 90 dias da publicação da lei que o criou ou aumentou." },
    { question: "A imunidade tributária concedida aos templos de qualquer culto abrange:", options: ["Apenas o imóvel onde se realiza o culto.", "O patrimônio, a renda e os serviços relacionados com as finalidades essenciais da entidade.", "Apenas o Imposto de Renda dos líderes religiosos.", "Todos os tributos, incluindo taxas e contribuições."], answer: "O patrimônio, a renda e os serviços relacionados com as finalidades essenciais da entidade.", feedback: "A imunidade dos templos (Art. 150, VI, 'b', da CF/88) é ampla, mas se restringe aos impostos e está condicionada a que o patrimônio, a renda e os serviços estejam relacionados às finalidades essenciais da entidade religiosa." },
    { question: "O Imposto sobre Grandes Fortunas (IGF) é de competência de qual ente federativo e depende de qual norma para ser instituído?", options: ["Dos Estados, por lei ordinária.", "Da União, por lei complementar.", "Dos Municípios, por lei complementar.", "Da União, por lei ordinária."], answer: "Da União, por lei complementar.", feedback: "O IGF (Art. 153, VII, da CF/88) é de competência exclusiva da União e, por ser um imposto não previsto de forma detalhada na Constituição, exige lei complementar para sua instituição." },
    { question: "A cobrança de uma taxa de fiscalização sanitária de um restaurante é um exemplo de taxa baseada em qual atividade estatal?", options: ["Prestação de serviço público específico e divisível.", "Exercício do poder de polícia.", "Obra pública.", "Intervenção no domínio econômico."], answer: "Exercício do poder de polícia.", feedback: "O poder de polícia é a atividade da administração que limita ou disciplina direito, interesse ou liberdade, regulando a prática de ato ou abstenção de fato, em razão de interesse público. A fiscalização é um exemplo clássico." },
    { question: "O que o princípio da isonomia tributária (ou igualdade) determina?", options: ["Que todos devem pagar o mesmo valor de tributo.", "Que a lei não pode dar tratamento desigual a contribuintes em situação equivalente.", "Que a alíquota do tributo deve ser sempre a mesma.", "Que os tributos não podem ser seletivos."], answer: "Que a lei não pode dar tratamento desigual a contribuintes em situação equivalente.", feedback: "O princípio da isonomia (Art. 150, II, da CF/88) proíbe a criação de distinções arbitrárias, garantindo que pessoas na mesma situação jurídica sejam tributadas da mesma forma." },
    { question: "O Simples Nacional é um regime especial de tributação. Qual sua principal característica?", options: ["Isenta as empresas de todos os tributos.", "Unifica o recolhimento de diversos tributos em uma única guia para micro e pequenas empresas.", "É um tributo único de competência federal.", "Aplica-se apenas a empresas prestadoras de serviço."], answer: "Unifica o recolhimento de diversos tributos em uma única guia para micro e pequenas empresas.", feedback: "O Simples Nacional é um regime tributário simplificado e favorecido (LC 123/2006) que permite o pagamento de vários tributos federais, estaduais e municipais através de um único Documento de Arrecadação (DAS)." },
    { question: "De acordo com o princípio da tipicidade, a lei que institui um tributo deve definir de forma clara e precisa:", options: ["Apenas a alíquota.", "Apenas o sujeito passivo.", "O fato gerador, a base de cálculo, a alíquota e o sujeito passivo.", "A destinação da receita."], answer: "O fato gerador, a base de cálculo, a alíquota e o sujeito passivo.", feedback: "Derivado da legalidade, o princípio da tipicidade (ou legalidade cerrada) exige que todos os elementos essenciais da regra-matriz de incidência tributária estejam previstos em lei, sem margem para discricionariedade do administrador." },
    { question: "O que o princípio da não-cumulatividade, aplicável ao IPI e ao ICMS, permite?", options: ["O não pagamento do tributo na etapa final.", "O aumento de alíquotas por decreto.", "A compensação do imposto pago nas operações anteriores com o devido nas operações posteriores.", "A isenção de impostos sobre produtos da cesta básica."], answer: "A compensação do imposto pago nas operações anteriores com o devido nas operações posteriores.", feedback: "A não-cumulatividade evita o 'efeito cascata', garantindo que o imposto incida apenas sobre o valor agregado em cada etapa da circulação da mercadoria ou da produção." },
    { question: "A imunidade de impostos sobre o patrimônio, renda e serviços de partidos políticos, suas fundações e entidades sindicais dos trabalhadores visa garantir:", options: ["A livre associação, a pluralidade política e a atuação sindical.", "A isenção fiscal para seus dirigentes.", "O direito de propriedade irrestrito.", "A imunidade para qualquer atividade econômica que exerçam."], answer: "A livre associação, a pluralidade política e a atuação sindical.", feedback: "Essa imunidade (Art. 150, VI, 'c', da CF/88) tem caráter político e visa proteger o livre funcionamento das instituições democráticas e da representação dos trabalhadores, desde que o patrimônio, a renda e os serviços estejam ligados às suas finalidades essenciais." },
    { question: "O Imposto sobre Circulação de Mercadorias e Serviços (ICMS) é de competência de qual ente federativo?", options: ["União.", "Estados e Distrito Federal.", "Municípios.", "Territórios Federais."], answer: "Estados e Distrito Federal.", feedback: "O ICMS é o principal imposto estadual (Art. 155, II, da CF/88), incidindo sobre uma vasta gama de operações com mercadorias e serviços." },
    { question: "O Imposto Sobre Serviços de Qualquer Natureza (ISS) tem sua lista de serviços tributáveis definida em:", options: ["Lei ordinária de cada município.", "Decreto do prefeito.", "Lei Complementar de âmbito nacional.", "Código Tributário Nacional."], answer: "Lei Complementar de âmbito nacional.", feedback: "Embora o ISS seja um imposto municipal (Art. 156, III, da CF/88), a lista de serviços sobre os quais ele pode incidir é definida pela Lei Complementar nº 116/2003 para padronizar e evitar conflitos de competência." },
    { question: "Qual modalidade de lançamento ocorre quando o Fisco, dispondo dos dados necessários, calcula o tributo e notifica o contribuinte para pagar (ex: IPTU)?", options: ["Lançamento por homologação.", "Lançamento por declaração.", "Lançamento de ofício.", "Auto de infração."], answer: "Lançamento de ofício.", feedback: "No lançamento de ofício ou direto (Art. 149 do CTN), a autoridade administrativa realiza todo o procedimento para constituir o crédito tributário sem a participação do contribuinte, como ocorre anualmente com o IPTU e o IPVA." },
    { question: "A constituição formal do crédito tributário ocorre com qual ato administrativo?", options: ["Ocorrência do fato gerador.", "Inscrição em dívida ativa.", "Lavratura do auto de infração.", "Lançamento."], answer: "Lançamento.", feedback: "Conforme o Art. 142 do CTN, o lançamento é o procedimento que torna a obrigação tributária (que nasce com o fato gerador) em um crédito líquido e certo, apto a ser cobrado." },
    { question: "A obrigação de manter livros fiscais e emitir notas é um exemplo de:", options: ["Obrigação principal.", "Obrigação acessória.", "Dever de ofício.", "Faculdade do contribuinte."], answer: "Obrigação acessória.", feedback: "A obrigação principal é o pagamento do tributo. A obrigação acessória (Art. 113, § 2º, do CTN) compreende os deveres instrumentais (fazer, não fazer, tolerar) que, se não cumpridos, convertem-se em obrigação principal (multa)." },
    { question: "O prazo de 5 anos para a Fazenda Pública realizar o lançamento do tributo é chamado de:", options: ["Prescrição.", "Decadência.", "Preclusão.", "Perempção."], answer: "Decadência.", feedback: "A decadência (Art. 173 do CTN) é a perda do direito da Fazenda de constituir o crédito tributário pelo lançamento. Se ela não o fizer em 5 anos, não poderá mais cobrar o tributo." },
    { question: "Após o lançamento definitivo, a Fazenda Pública tem 5 anos para ajuizar a ação de execução fiscal. Esse prazo é de:", options: ["Prescrição.", "Decadência.", "Anistia.", "Remissão."], answer: "Prescrição.", feedback: "A prescrição (Art. 174 do CTN) é a perda do direito de ação, ou seja, do direito de cobrar judicialmente um crédito já constituído. O prazo também é de 5 anos." },
    { question: "O Imposto sobre Transmissão Causa Mortis e Doação (ITCMD) é de competência de qual ente federativo?", options: ["União.", "Municípios.", "Estados e Distrito Federal.", "Competência comum."], answer: "Estados e Distrito Federal.", feedback: "O ITCMD, que incide sobre a transmissão gratuita de bens ou direitos (herança ou doação), é um imposto de competência estadual e distrital (Art. 155, I, da CF/88)." },
    { question: "O Imposto sobre a Propriedade Territorial Rural (ITR), embora de competência da União, pode ter sua fiscalização e cobrança delegadas aos:", options: ["Estados, mediante convênio.", "Municípios, mediante opção.", "Cartórios de Registro de Imóveis.", "INCRA."], answer: "Municípios, mediante opção.", feedback: "A Constituição (Art. 153, § 4º, III) permite que os Municípios que optarem por fiscalizar e cobrar o ITR fiquem com 100% da arrecadação, como forma de incentivar a fiscalização local." },
    { question: "Qual a diferença fundamental entre Imunidade e Isenção?", options: ["Imunidade é para impostos, isenção é para taxas.", "Imunidade é uma dispensa legal do pagamento, e isenção é uma vedação constitucional.", "Imunidade é uma vedação constitucional ao poder de tributar, e isenção é uma dispensa do pagamento prevista em lei.", "Imunidade é total e isenção é parcial."], answer: "Imunidade é uma vedação constitucional ao poder de tributar, e isenção é uma dispensa do pagamento prevista em lei.", feedback: "A imunidade está no plano da competência; o ente sequer pode criar o imposto naquela situação. A isenção está no plano do exercício da competência; o ente pode criar o imposto, mas a lei opta por dispensar o pagamento." },
    { question: "Quem é o sujeito passivo da obrigação tributária?", options: ["Apenas o contribuinte.", "O contribuinte ou o responsável tributário.", "Apenas a pessoa que aufere renda.", "O ente federativo que cobra o tributo."], answer: "O contribuinte ou o responsável tributário.", feedback: "O sujeito passivo, conforme o CTN, é a pessoa obrigada ao pagamento do tributo. Pode ser o contribuinte (quem realiza o fato gerador) ou o responsável (terceiro a quem a lei atribui o dever de pagar)." },
    { question: "A responsabilidade tributária dos sucessores (herdeiros) é limitada a qual valor?", options: ["Ao valor total da dívida do falecido.", "É ilimitada, respondendo com seu patrimônio pessoal.", "Ao valor do patrimônio herdado (quinhão).", "A 50% do valor da dívida."], answer: "Ao valor do patrimônio herdado (quinhão).", feedback: "De acordo com o Art. 131, II, do CTN, a responsabilidade dos herdeiros pelas dívidas tributárias do 'de cujus' é limitada às forças da herança, protegendo o patrimônio pessoal do sucessor." },
    { question: "No mecanismo da substituição tributária 'para frente', comum no ICMS, o que acontece?", options: ["O consumidor final paga o imposto diretamente ao Estado.", "O varejista é responsável por recolher o imposto de toda a cadeia.", "O fabricante ou importador recolhe antecipadamente o imposto devido por toda a cadeia de circulação.", "O imposto é pago apenas na última operação."], answer: "O fabricante ou importador recolhe antecipadamente o imposto devido por toda a cadeia de circulação.", feedback: "Na substituição tributária 'para frente', a lei atribui a um contribuinte no início da cadeia (o substituto) a responsabilidade de recolher o ICMS que incidiria nas operações futuras, até chegar ao consumidor final." },
    { question: "O parcelamento de um débito tributário é uma causa de:", options: ["Extinção do crédito.", "Exclusão do crédito.", "Suspensão da exigibilidade do crédito.", "Remissão do crédito."], answer: "Suspensão da exigibilidade do crédito.", feedback: "O parcelamento (Art. 151, VI, do CTN) é uma modalidade de moratória que suspende o direito do Fisco de cobrar a dívida, desde que o contribuinte esteja pagando as parcelas em dia." },
    { question: "O pagamento integral do crédito tributário é a principal causa de sua:", options: ["Suspensão.", "Extinção.", "Exclusão.", "Modificação."], answer: "Extinção.", feedback: "O pagamento é a forma mais comum e direta de extinção do crédito tributário, conforme previsto no Art. 156, I, do CTN. Uma vez pago, o crédito deixa de existir." },
    { question: "O que é a Dívida Ativa?", options: ["O conjunto de todos os tributos devidos no país.", "O crédito da Fazenda Pública, vencido e não pago, após inscrição em registro próprio.", "O valor que a União deve aos Estados.", "A dívida de um contribuinte com bancos privados."], answer: "O crédito da Fazenda Pública, vencido e não pago, após inscrição em registro próprio.", feedback: "A Dívida Ativa é o cadastro que reúne os créditos líquidos e certos da Fazenda Pública. A inscrição nesse cadastro torna a dívida apta à cobrança judicial (execução fiscal)." },
    { question: "Qual o nome do título executivo extrajudicial que embasa a execução fiscal?", options: ["Auto de Infração.", "Notificação de Lançamento.", "Certidão de Dívida Ativa (CDA).", "Mandado de Segurança."], answer: "Certidão de Dívida Ativa (CDA).", feedback: "A Certidão de Dívida Ativa (CDA) é o documento, com presunção de liquidez e certeza, que serve de base para a Fazenda Pública ajuizar a Ação de Execução Fiscal e cobrar judicialmente o crédito." },
    { question: "O Imposto sobre a Transmissão de Bens Imóveis (ITBI) 'inter vivos' e a título oneroso é de competência dos:", options: ["Estados.", "União.", "Cartórios.", "Municípios e Distrito Federal."], answer: "Municípios e Distrito Federal.", feedback: "O ITBI (Art. 156, II, da CF/88) é um imposto municipal que incide sobre a compra e venda de imóveis e outros atos onerosos." },
    { question: "A alíquota do Imposto de Renda da Pessoa Física (IRPF) ser maior para quem ganha mais é uma aplicação direta do princípio da:", options: ["Seletividade.", "Progressividade.", "Não-cumulatividade.", "Uniformidade."], answer: "Progressividade.", feedback: "A progressividade é a manifestação do princípio da capacidade contributiva, fazendo com que a alíquota do imposto aumente à medida que a base de cálculo (a renda) também aumenta." },
    { question: "A imunidade de impostos para instituições de educação e de assistência social sem fins lucrativos exige o cumprimento de requisitos previstos em:", options: ["Lei ordinária.", "Decreto.", "Lei complementar.", "Portaria."], answer: "Lei complementar.", feedback: "O Art. 146, II, da CF/88, estabelece que cabe à lei complementar regular as limitações constitucionais ao poder de tributar. O Art. 14 do CTN (recepcionado como lei complementar) traz os requisitos para a fruição dessa imunidade." },
    { question: "Se o Fisco discordar do valor declarado pelo contribuinte em um tributo sujeito a lançamento por homologação (ex: ICMS), ele deve efetuar um:", options: ["Lançamento de ofício.", "Novo lançamento por homologação.", "Lançamento por arbitramento.", "Cancelamento do débito."], answer: "Lançamento de ofício.", feedback: "Quando o Fisco constata que o pagamento foi insuficiente ou incorreto, ele deve efetuar um lançamento de ofício (ou auto de infração) para cobrar a diferença apurada, dentro do prazo decadencial de 5 anos." },
    { question: "Qual das seguintes opções é uma causa de suspensão da exigibilidade do crédito tributário?", options: ["Prescrição.", "Decadência.", "Depósito do montante integral.", "Isenção."], answer: "Depósito do montante integral.", feedback: "O depósito do montante integral em dinheiro (Art. 151, II, do CTN) suspende a exigibilidade do crédito, permitindo que o contribuinte discuta a dívida sem sofrer atos de cobrança, como a execução fiscal." },
    { question: "A anistia, como causa de exclusão do crédito tributário, perdoa:", options: ["O tributo principal.", "As multas decorrentes de infrações à legislação.", "Os juros de mora.", "Tanto o tributo quanto as multas."], answer: "As multas decorrentes de infrações à legislação.", feedback: "A anistia (Art. 180 do CTN) é o perdão das penalidades pecuniárias (multas) aplicadas por infrações. Ela não afeta a obrigação de pagar o tributo em si." },
    { question: "Qual o prazo para o contribuinte solicitar a devolução de um tributo pago indevidamente (repetição de indébito)?", options: ["2 anos.", "3 anos.", "5 anos.", "10 anos."], answer: "5 anos.", feedback: "O direito de pleitear a restituição de um tributo pago indevidamente extingue-se com o decurso do prazo de 5 anos, contados da data da extinção do crédito tributário (Art. 168 do CTN)." },
    { question: "O que acontece com uma obrigação acessória (ex: entregar uma declaração) quando ela não é cumprida?", options: ["Ela é perdoada.", "Ela se converte em obrigação principal (multa).", "O Fisco a cumpre pelo contribuinte.", "Ela prescreve em 1 ano."], answer: "Ela se converte em obrigação principal (multa).", feedback: "O Art. 113, § 3º, do CTN estabelece que a obrigação acessória, pelo simples fato da sua inobservância, converte-se em obrigação principal relativamente à penalidade pecuniária." },
    { question: "O fato gerador do Imposto sobre Produtos Industrializados (IPI) ocorre, em geral:", options: ["Na venda do produto ao consumidor.", "No desembaraço aduaneiro (importação) ou na saída do produto do estabelecimento industrial.", "Na compra da matéria-prima.", "No transporte da mercadoria."], answer: "No desembaraço aduaneiro (importação) ou na saída do produto do estabelecimento industrial.", feedback: "O fato gerador do IPI está ligado ao processo de industrialização. Ocorre no desembaraço aduaneiro, se o produto for importado, ou na saída do estabelecimento do industrial ou equiparado." },
    { question: "O que são serviços públicos 'uti singuli'?", options: ["Serviços que beneficiam a todos, de forma indistinta.", "Serviços prestados apenas pela União.", "Serviços que têm usuários determinados e cuja utilização pode ser medida individualmente.", "Serviços de segurança pública."], answer: "Serviços que têm usuários determinados e cuja utilização pode ser medida individualmente.", feedback: "Serviços 'uti singuli' ou divisíveis são aqueles cuja utilização por cada usuário pode ser mensurada, como a coleta de lixo domiciliar ou a emissão de um documento. Por isso, podem ser remunerados por taxas." },
    { question: "A base de cálculo de uma taxa pode ser idêntica à de um imposto?", options: ["Sim, desde que previsto em lei municipal.", "Não, conforme vedação expressa na Constituição.", "Sim, apenas para taxas federais.", "Apenas se a alíquota for diferente."], answer: "Não, conforme vedação expressa na Constituição.", feedback: "O Art. 145, § 2º, da Constituição Federal veda expressamente que as taxas tenham base de cálculo própria de impostos. Essa é uma regra para evitar que impostos sejam cobrados com o nome de 'taxa'." },
    { question: "A responsabilidade tributária de um sócio-gerente por dívidas da empresa (pessoa jurídica) ocorre quando?", options: ["Sempre que a empresa não tiver patrimônio.", "Apenas em caso de falência.", "Quando age com excesso de poderes, infração à lei, contrato social ou estatuto.", "Nunca, pois a responsabilidade é sempre da pessoa jurídica."], answer: "Quando age com excesso de poderes, infração à lei, contrato social ou estatuto.", feedback: "A responsabilidade do sócio não é automática. O redirecionamento da execução fiscal para o sócio-gerente depende da comprovação de que ele agiu de forma ilícita, com dolo ou fraude, conforme o Art. 135 do CTN." },
    { question: "Qual a natureza jurídica do pedágio?", options: ["Imposto.", "Taxa.", "Preço público ou tarifa.", "Contribuição de melhoria."], answer: "Preço público ou tarifa.", feedback: "O STF firmou o entendimento de que o pedágio não é tributo, mas sim um preço público (tarifa), de natureza contratual e facultativa, pago pela utilização de um serviço (rodovia conservada) prestado diretamente pelo Estado ou por concessionária." },
    { question: "A Contribuição para o Custeio do Serviço de Iluminação Pública (COSIP/CIP) é de competência de qual ente federativo?", options: ["União.", "Estados.", "Concessionárias de energia.", "Municípios e Distrito Federal."], answer: "Municípios e Distrito Federal.", feedback: "A COSIP/CIP (Art. 149-A da CF/88) é uma contribuição especial de competência municipal, destinada a custear o serviço de iluminação pública." },
    { question: "O que o princípio da transparência fiscal (Lei do Imposto na Nota) exige?", options: ["Que o Fisco publique todas as suas arrecadações.", "Que a carga tributária incidente sobre produtos e serviços seja informada ao consumidor no documento fiscal.", "Que as leis tributárias sejam escritas em linguagem simples.", "Que o balanço das empresas seja público."], answer: "Que a carga tributária incidente sobre produtos e serviços seja informada ao consumidor no documento fiscal.", feedback: "Este princípio busca dar ao cidadão a consciência do quanto ele paga em tributos em cada compra, informando o valor aproximado dos tributos federais, estaduais e municipais embutidos no preço." },
    { question: "A 'guerra fiscal' entre os Estados refere-se, principalmente, à concessão de benefícios fiscais de qual imposto sem autorização do CONFAZ?", options: ["IPVA.", "ITCMD.", "ICMS.", "Imposto de Renda."], answer: "ICMS.", feedback: "A 'guerra fiscal' ocorre quando Estados concedem unilateralmente benefícios de ICMS (ex: isenções, redução de base de cálculo) para atrair empresas, violando a exigência constitucional (Art. 155, § 2º, XII, 'g') de que tais benefícios sejam aprovados por convênio no âmbito do CONFAZ." },
    { question: "O que é o fato gerador da obrigação tributária?", options: ["A lei que cria o tributo.", "A situação descrita em lei como necessária e suficiente para a ocorrência da obrigação.", "A cobrança efetuada pelo Fisco.", "O pagamento do tributo."], answer: "A situação descrita em lei como necessária e suficiente para a ocorrência da obrigação.", feedback: "O fato gerador (Art. 114 do CTN) é a materialização, no mundo real, da hipótese abstrata prevista na lei. Por exemplo, o fato gerador do imposto de renda é auferir renda." },
    { question: "A moratória, que consiste na dilação do prazo para pagamento do tributo, é uma causa de:", options: ["Extinção do crédito tributário.", "Suspensão da exigibilidade do crédito tributário.", "Exclusão do crédito tributário.", "Anistia."], answer: "Suspensão da exigibilidade do crédito tributário.", feedback: "A moratória (Art. 151, I, do CTN) não perdoa a dívida, apenas adia o prazo para seu pagamento, suspendendo temporariamente a possibilidade de cobrança por parte do Fisco." },
    { question: "A imunidade de impostos para entidades de assistência social sem fins lucrativos, como uma ONG que atende crianças carentes, tem como objetivo:", options: ["Garantir a livre iniciativa.", "Proteger a liberdade de associação e a atuação no terceiro setor.", "Isentar seus diretores de pagar Imposto de Renda.", "Permitir que a entidade distribua lucros."], answer: "Proteger a liberdade de associação e a atuação no terceiro setor.", feedback: "Essa imunidade (Art. 150, VI, 'c', CF/88) visa fomentar a atuação da sociedade civil em áreas de interesse social, desonerando entidades que complementam a atuação do Estado, desde que não distribuam lucros e atendam aos requisitos legais." },
    { question: "Se uma lei nova reduzir a alíquota de um imposto, ela pode retroagir para beneficiar o contribuinte em relação a fatos geradores passados?", options: ["Não, pois o princípio da irretroatividade é absoluto.", "Sim, apenas se for uma lei complementar.", "Sim, a lei tributária pode retroagir quando for mais benéfigna em matéria de penalidades.", "Não, exceto para taxas."], answer: "Sim, a lei tributária pode retroagir quando for mais benéfigna em matéria de penalidades.", feedback: "A regra geral é a irretroatividade. Contudo, o Art. 106 do CTN permite a retroatividade da lei quando ela deixa de definir um ato como infração ou quando comina uma penalidade menos severa (lei mais benéfica em matéria de infrações)." },
    { question: "O que é o lançamento por declaração?", options: ["O Fisco calcula e cobra o tributo, sem participação do contribuinte.", "O contribuinte informa os dados ao Fisco, que então calcula o tributo e notifica para pagamento.", "O contribuinte calcula, declara e paga, e o Fisco apenas confere posteriormente.", "É o mesmo que auto de infração."], answer: "O contribuinte informa os dados ao Fisco, que então calcula o tributo e notifica para pagamento.", feedback: "No lançamento por declaração (Art. 147 do CTN), o contribuinte presta à autoridade as informações necessárias sobre a matéria de fato, e com base nelas, o Fisco efetua o cálculo e o lançamento. É comum em impostos como o ITBI e o ITCMD." },
    { question: "A compensação é uma forma de extinção do crédito tributário que ocorre quando:", options: ["O contribuinte paga a dívida com bens.", "O Fisco perdoa a dívida.", "O contribuinte e a Fazenda Pública são, ao mesmo tempo, credores e devedores um do outro.", "O contribuinte parcela o débito."], answer: "O contribuinte e a Fazenda Pública são, ao mesmo tempo, credores e devedores um do outro.", feedback: "A compensação (Art. 156, II, e Art. 170 do CTN) extingue o crédito tributário quando o contribuinte, tendo um crédito contra a Fazenda (ex: pagamento indevido), o utiliza para quitar um débito tributário, conforme previsto em lei." }
  ];

  let currentQuestionIndex = 0;
  let score = 0;
  let userAnswers = {}; // Armazena as respostas do usuário {index: "texto da resposta"}
  
  // Elementos do DOM
  const progressBar = document.getElementById("progress-bar");
  const progressBarContainer = document.getElementById("progress-bar-container");
  const progressText = document.getElementById("progress-text");
  const statusText = document.getElementById("status-text");
  const questionText = document.getElementById("question-text");
  const optionsContainer = document.getElementById("options-container");
  const feedbackBox = document.getElementById("feedback-box");
  const feedbackText = document.getElementById("feedback-text");
  const prevButton = document.getElementById("prev-button");
  const nextButton = document.getElementById("next-button");
  const finalResult = document.getElementById("final-result");
  const finalResultText = document.getElementById("final-result-text");
  const restartButton = document.getElementById("restart-button");
  const quizContent = document.getElementById('quiz-content');

  /**
   * Embaralha um array no lugar usando o algoritmo Fisher-Yates.
   * @param {Array} array O array a ser embaralhado.
   */
  function shuffleArray(array) {
    for (let i = array.length - 1; i > 0; i--) {
      const j = Math.floor(Math.random() * (i + 1));
      [array[i], array[j]] = [array[j], array[i]];
    }
  }

  function renderQuestion() {
    // Esconde o resultado final e mostra o conteúdo do quiz
    finalResult.classList.add('hidden');
    quizContent.classList.remove('hidden');
    feedbackBox.style.display = 'none';

    // Pega a questão atual
    const q = questions[currentQuestionIndex];
    
    // Atualiza a barra de progresso e textos
    const progressPercentage = ((currentQuestionIndex) / questions.length) * 100;
    progressBar.style.width = `${progressPercentage}%`;
    progressText.textContent = `Questão ${currentQuestionIndex + 1} de ${questions.length}`;
    
    // Atualiza o texto da questão
    questionText.textContent = q.question;
    optionsContainer.innerHTML = '';
    
    // Embaralha as opções para esta questão
    const shuffledOptions = [...q.options];
    shuffleArray(shuffledOptions);

    // Cria os botões de opção
    shuffledOptions.forEach(option => {
      const button = document.createElement('button');
      button.textContent = option;
      button.onclick = () => handleAnswer(option);
      optionsContainer.appendChild(button);
    });

    // Se a questão já foi respondida, mostra o estado anterior
    if (userAnswers[currentQuestionIndex] !== undefined) {
      showAnswerFeedback(userAnswers[currentQuestionIndex]);
    }

    updateNavigationButtons();
    updateStatusText();
  }

  function handleAnswer(selectedOption) {
    // Impede nova resposta se já respondeu
    if (userAnswers[currentQuestionIndex] !== undefined) {
      return;
    }
    
    userAnswers[currentQuestionIndex] = selectedOption;
    showAnswerFeedback(selectedOption);

    if (selectedOption === questions[currentQuestionIndex].answer) {
      score++;
    }
    
    updateStatusText();
    updateNavigationButtons();
  }

  function showAnswerFeedback(selectedOption) {
    const q = questions[currentQuestionIndex];
    const optionButtons = optionsContainer.querySelectorAll('button');

    optionButtons.forEach(button => {
      button.disabled = true; // Desabilita todos os botões
      if (button.textContent === q.answer) {
        button.classList.add('correct');
      }
      if (button.textContent === selectedOption && selectedOption !== q.answer) {
        button.classList.add('incorrect');
      }
    });
    
    // Mostra a caixa de feedback e ajusta a cor
    feedbackBox.style.display = 'block';
    feedbackBox.classList.remove('incorrect-feedback');

    let feedbackHeader;
    if (selectedOption === q.answer) {
      feedbackHeader = '<p class="font-bold text-lg mb-2">Certo!</p>';
    } else {
      feedbackBox.classList.add('incorrect-feedback');
      feedbackHeader = '<p class="font-bold text-lg mb-2">Errado!</p>';
    }

    feedbackText.innerHTML = `${feedbackHeader}<strong>Justificativa:</strong> ${q.feedback}`;
  }
  
  function updateStatusText() {
    const totalAnswered = Object.keys(userAnswers).length;
    const remaining = questions.length - totalAnswered;
    statusText.textContent = `${score} acertos, ${remaining} restantes`;
  }

  function updateNavigationButtons() {
    prevButton.disabled = currentQuestionIndex === 0;
    nextButton.textContent = currentQuestionIndex === questions.length - 1 ? 'Finalizar' : 'Avançar';
  }

  function nextQuestion() {
    if (currentQuestionIndex < questions.length - 1) {
      currentQuestionIndex++;
      renderQuestion();
    } else {
      showFinalResult();
    }
  }

  function prevQuestion() {
    if (currentQuestionIndex > 0) {
      currentQuestionIndex--;
      renderQuestion();
    }
  }

  function showFinalResult() {
    quizContent.classList.add('hidden');
    finalResult.classList.remove('hidden');
    
    const percentage = ((score / questions.length) * 100).toFixed(1);
    finalResultText.innerHTML = `Seu resultado: ${score} de ${questions.length} corretas.<br> (${percentage}%)`;

    // Esconde navegação e cabeçalho
    prevButton.style.display = 'none';
    nextButton.style.display = 'none';
    progressText.style.display = 'none';
    statusText.style.display = 'none';
    progressBarContainer.style.display = 'none';
  }

  function startQuiz() {
    currentQuestionIndex = 0;
    score = 0;
    userAnswers = {};

    // Embaralha as questões para um novo início
    shuffleArray(questions);
    
    // Mostra os elementos do quiz novamente
    quizContent.classList.remove('hidden');
    finalResult.classList.add('hidden');
    prevButton.style.display = 'block';
    nextButton.style.display = 'block';
    progressText.style.display = 'block';
    statusText.style.display = 'block';
    progressBarContainer.style.display = 'block';
    
    renderQuestion();
  }

  // Adiciona os listeners
  prevButton.addEventListener('click', prevQuestion);
  nextButton.addEventListener('click', nextQuestion);
  restartButton.addEventListener('click', startQuiz);
  
  // Inicia o quiz pela primeira vez
  startQuiz();

</script>

</body>
</html>



